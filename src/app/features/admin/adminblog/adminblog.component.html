<div class="flex justify-start gap-5">
  <app-sidebar class=""></app-sidebar>
  @if(loading){
    <app-loading-spinner></app-loading-spinner>
    }
  @else{
    <div class="text-white mt-5 w-full">
      <div class="flex gap-2 mb-5">
        <div class="flex flex-col">
          <label for="user">User</label>
          <input [(ngModel)]="user" class="p-1 bg-slate-600/30 border border-slate-300/30 rounded-lg w-max" type="text" name="user">
        </div>
        <div class="flex flex-col">
          <label for="password">Password</label>
          <input [(ngModel)]="password" class="p-1 bg-slate-600/30 border border-slate-300/30 rounded-lg w-max" type="password" name="password">
        </div>

        <div class="flex flex-col justify-end">
        @if (!creating){
          <button
            class="text-sm px-3 py-2 rounded-md bg-green-600 text-white hover:bg-green-700 hover:cursor-pointer"
            (click)="toggleCreatePanel()"
          >
            Create
          </button>
        }@else {
          <button
            class="text-sm px-3 py-2 rounded-md bg-red-600 text-white hover:bg-red-700 hover:cursor-pointer"
            (click)="toggleCreatePanel()"
          >
            Cancel
          </button>
          }
        </div>
      </div>
      @if (creating && editPost != null) {
        <div class="flex w-full">
          <div class="mt-5 min-h-screen text-white min-w-1/2">
            <h1 class="text-white text-xl uppercase">Creating post</h1>
            <div class="mt-4 flex flex-col mr-5">
              <label class="font-bold mt-3 uppercase" for="author">Author</label>
              <input class="p-1 bg-slate-600/30 border border-slate-300/30 rounded-lg "
              type="text" [(ngModel)]="editPost.author" name="author">

              <label class="font-bold mt-3 uppercase" for="title">title</label>
              <input class="p-1 bg-slate-600/30 border border-slate-300/30 rounded-lg "
              type="text" [(ngModel)]="editPost.title" name="title">

              <label class="font-bold mt-3 uppercase" for="description">description</label>
              <input class="p-1 bg-slate-600/30 border border-slate-300/30 rounded-lg "
              type="text" [(ngModel)]="editPost.description" name="description">
              <p>Description doesn't have a preview</p>

              <label class="font-bold mt-3 uppercase" for="content">content</label>
              <textarea class="p-1 bg-slate-600/30 border border-slate-300/30 rounded-lg "
                type="text" [(ngModel)]="editPost.content" name="content" rows="10"
                (keydown)="utils.handleTab($event)"
              ></textarea>

              <div class="flex">
                <button
                  class="text-sm p-2 rounded-md bg-green-600 text-white hover:bg-green-700 hover:cursor-pointer min-w-1/8 mt-5"
                    (click)="confirmCreate()"
                >
                 Confirm
                </button>
              </div>
            </div>
          </div>
          <div class="border-l border-l-slate-500/30 w-full max-w-1/2 pl-5">
            <render-post [post]="editPost"></render-post>
          </div>
        </div>
      }
      @else {
      <div class="flex">
        <div class="max-h-screen overflow-y-auto min-w-1/3">
          @for (item of getPosts(); track item) {
          <div
            class="border-b border-b-slate-500/30 hover:rounded-lg p-3 flex flex-col gap-2 justify-center hover:bg-slate-700/50 transition-all"
          >
            <div class="flex gap-2">
              <p class="font-semibold">{{item.id}}. {{ item.title }}</p>
              <p class="ml-3 text-white/60">{{ item.date }}</p>
            </div>
            <p class="text-white/60">{{ item.author }}</p>
            <p class="text-white/80">{{ item.description }}</p>
            <div class="flex">
              <button
                class="text-sm px-3 py-1 rounded-md bg-sky-600 text-white hover:bg-sky-700 hover:cursor-pointer"
                (click)="edit(item)"
              >
                Edit
              </button>

              <button
                class="text-sm px-3 py-1 rounded-md bg-red-600 text-white ml-2 hover:bg-red-700 hover:cursor-pointer"
                  (click)="delete(item.id ?? -1)"
              >
                Delete
              </button>
            </div>
          </div>
        }
        </div>
          @if(editPost != null){
            <div class="mt-5 pl-5 min-h-screen border-l border-l-slate-500/30 text-white w-full">
              <h1 class="text-white text-xl uppercase">EDITING {{editPost.id}}</h1>
              <div class="mt-4 flex flex-col">

                <label class="font-bold mt-3 uppercase" for="author">Author</label>
                <input class="p-1 bg-slate-600/30 border border-slate-300/30 rounded-lg w-3/4"
                type="text" [(ngModel)]="editPost.author" name="author">

                <label class="font-bold mt-3 uppercase" for="title">title</label>
                <input class="p-1 bg-slate-600/30 border border-slate-300/30 rounded-lg w-3/4"
                type="text" [(ngModel)]="editPost.title" name="title">

                <label class="font-bold mt-3 uppercase" for="description">description</label>
                <input class="p-1 bg-slate-600/30 border border-slate-300/30 rounded-lg w-3/4"
                type="text" [(ngModel)]="editPost.description" name="description">

                <label class="font-bold mt-3 uppercase" for="content">content</label>
                <textarea class="p-1 bg-slate-600/30 border border-slate-300/30 rounded-lg w-3/4"
                type="text" [(ngModel)]="editPost.content" name="content" rows="10"></textarea>

                <div class="flex gap-2">
                  <button
                    class="text-sm p-2 rounded-md bg-green-600 text-white hover:bg-green-700 hover:cursor-pointer w-1/8 mt-5"
                      (click)="confirmEdit()"
                  >
                   Confirm
                  </button>

                  <button
                    class="text-sm p-2 rounded-md bg-blue-600 text-white hover:bg-blue-700 hover:cursor-pointer w-1/8 mt-5"
                      (click)="cancelEdit()"
                  >
                   Cancel
                  </button>
                </div>
              </div>
            </div>
          }
    </div>
  }
  </div>
  }
</div>
